<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>Email Credential Form</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

Â  <main class="max-w-xl mx-auto px-4 py-10">
Â  Â  <section class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100">
Â  Â  Â  <h2 class="text-2xl font-semibold mb-4">ðŸ“§ Submit Email Credentials</h2>
Â  Â  Â  
Â  Â  Â  <!-- Balance Display -->
Â  Â  Â  <p id="userBalance" class="text-lg sm:text-xl font-bold text-green-600 mb-4">à§³0</p>
Â  Â  Â  
Â  Â  Â  <form id="emailForm" class="space-y-4">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
Â  Â  Â  Â  Â  <input type="email" id="email" name="email" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring focus:ring-indigo-200" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <label for="password" class="block text-sm font-medium text-gray-700">Email Password</label>
Â  Â  Â  Â  Â  <input type="password" id="password" name="password" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring focus:ring-indigo-200" />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button type="submit" class="bg-indigo-600 text-white px-5 py-2 rounded-md hover:bg-indigo-700 transition">
Â  Â  Â  Â  Â  Submit
Â  Â  Â  Â  </button>
Â  Â  Â  </form>
Â  Â  </section>
Â  </main>

Â  <!-- Firebase SDK -->
Â  <script type="module">
Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyCkYWvYNsg2-CR88Js6gcP2nXfvwI4TW30",
Â  Â  Â  authDomain: "bdwork-346d3.firebaseapp.com",
Â  Â  Â  projectId: "bdwork-346d3",
Â  Â  Â  storageBucket: "bdwork-346d3.appspot.com",
Â  Â  Â  messagingSenderId: "900963179093",
Â  Â  Â  appId: "1:900963179093:web:81e42d67bb31d603cc92dc",
Â  Â  Â  measurementId: "G-FM1YJ8E5GK"
Â  Â  };

Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
Â  Â  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
Â  Â  import {
Â  Â  Â  getFirestore, doc, getDoc, collection, addDoc, serverTimestamp
Â  Â  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const auth = getAuth(app);
Â  Â  const db = getFirestore(app);

Â  Â  let currentUserData = null;

Â  Â  onAuthStateChanged(auth, async (user) => {
Â  Â  Â  if (!user) {
Â  Â  Â  Â  window.location.href = "login.html";
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  const userDocRef = doc(db, "users", user.uid);
Â  Â  Â  Â  const userDoc = await getDoc(userDocRef);
Â  Â  Â  Â  if (userDoc.exists()) {
Â  Â  Â  Â  Â  const data = userDoc.data();
Â  Â  Â  Â  Â  currentUserData = { uid: user.uid, ...data };
Â  Â  Â  Â  Â  document.getElementById("userBalance").innerText = `à§³${data.balance || 0}`;
Â  Â  Â  Â  }
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  console.error("Failed to fetch user data:", err);
Â  Â  Â  }
Â  Â  });

Â  Â  const emailForm = document.getElementById("emailForm");

Â  Â  emailForm.addEventListener("submit", async (e) => {
Â  Â  Â  e.preventDefault();
Â  Â  Â  const email = document.getElementById("email").value.trim();
Â  Â  Â  const password = document.getElementById("password").value.trim();

Â  Â  Â  if (!email || !password) {
Â  Â  Â  Â  alert("Please fill in both fields.");
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  await addDoc(collection(db, "emailCredentials"), {
Â  Â  Â  Â  Â  email: email,
Â  Â  Â  Â  Â  password: password,
Â  Â  Â  Â  Â  submittedAt: serverTimestamp(),
Â  Â  Â  Â  Â  userId: currentUserData?.uid || null
Â  Â  Â  Â  });

Â  Â  Â  Â  alert("Submitted successfully!");
Â  Â  Â  Â  emailForm.reset();
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error adding document:", error);
Â  Â  Â  Â  alert("Failed to submit. Try again.");
Â  Â  Â  }
Â  Â  });
Â  </script>
</body>
</html>
